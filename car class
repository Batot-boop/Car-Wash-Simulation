import java.util.concurrent.atomic.AtomicInteger;

public class Car extends Thread {
    private static final AtomicInteger idCounter = new AtomicInteger(1);
    private final int carID;
    private final ServiceStation station;
    private final Synchronization gui;

    public Car(ServiceStation station, Synchronization gui) {
        this.carID = idCounter.getAndIncrement();
        this.station = station;
        this.gui = gui;
    }

    public void run() {
        try {
            gui.log("Car " + carID + " arrived.");

            station.empty.waitSem();

            station.mutex.waitSem();
            station.addCar(this);
            gui.log("Car " + carID + " entered waiting queue.");
            station.mutex.signal();

            station.full.signal();

        } catch (Exception e) {
            gui.log("Error in Car " + carID + ": " + e.getMessage());
        }
    }

    public int getCarID() {
        return carID;
    }
}
